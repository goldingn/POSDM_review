# Predicting probability of presence with presence-only species distribution models

## The naïve model

Probably the most common approach is to augment the occurrence data with background (AKA pseudo-absence) datapoints sampled from the study area according to some scheme or other and then to fit one of the broad array of presence-absence (binomial likelihood) models, treating the background data as absences. In her PhD thesis Trevor Hastie’s student Gill Ward termed this the ‘naïve model’ for dealing with presence-only data ([Ward (2007)](http://www.stanford.edu/~hastie/THESES/Gill_Ward.pdf)).

## MaxEnt

The other commonly used approach is MaxEnt ([Phillips *et al.* (2006)](http://www.cs.princeton.edu/~schapire/papers/ecolmod.pdf); [Phillips & Dudik (2011)](http://onlinelibrary.wiley.com/doi/10.1111/j.0906-7590.2008.5203.x/abstract)). MaxEnt differs from most other SDMs in a few important ways that made it very popular:

1. It defines a likelihood function for presence-only modeling by minimizing the relative entropy between the distribution of presence points and randomly sampled background points ([Elith *et al.* (2011)](http://www.research.att.com/export/sites/att_labs/techdocs/TD_100253.pdf) give an intuitive exaplanation)
2. It includes very effective procedures for adding nonlinearities to the model and preventing overfitting
3. It includes a user-friendly point-and-click program

Unlike the naïve model, MaxEnt outputs aren’t bound between 0 and 1. The MaxEnt software provides a rescaling to bind this between 0 and 1 and call the resulting index the ‘logistic output’ that ‘gives an estimate of probability of presence’. This is a bit of a fudge as it can predict values greater than 1, but more worryingly it is only even nearly valid when its assumption of a prevalence (proportion of grid cells occupied) of 0.5 across the study area is met ([Phillips & Dudik (2011)](http://onlinelibrary.wiley.com/doi/10.1111/j.0906-7590.2008.5203.x/abstract)). This is widely (around 54% of papers; [Yackulic *et al.* (2013)](http://onlinelibrary.wiley.com/doi/10.1111/2041-210x.12004/abstract)) misinterpreted by users as predicting the probability of presence of their species, which it clearly isn’t. [Elith *et al.* (2011)](http://www.research.att.com/export/sites/att_labs/techdocs/TD_100253.pdf) give an interpretation of MaxEnt’s logistic output as a ‘correct’ probability of presence for some unknown level of sampling effort. Though this interpretation doesn’t help users who want to use the predictions to make operational decisions – which covers most SDM users. What many people really want from these maps is a pixel-level probability that their species is present, at least for a known sampling effort. Hence they assume that the statistical methods they’re applying give them that.

While it was always known that the MaxEnt software described a Gibbs distribution (i.e. that the model belonged to the same "exponential family" of probability distributions as the Gaussian and binomial distributions), it was not known at the time where it fit within that family. As a result, designing new (non-naive) presence-only models would have required replicating a great deal of work that had already been performed by Phillips et al, and it was generally easier to just use their sofware as-is (even if it wasn't completely appropriate).  In the last few years, however, it has become clear that the probability distribution described by the MaxEnt software is a point process, and that it can be modeled exactly with the Poisson distribution ([Fithian & Hastie (2012)](http://arxiv.org/abs/1207.6950); [Renner & Warton (2013)](http://onlinelibrary.wiley.com/doi/10.1111/j.1541-0420.2012.01824.x/abstract)).  These insights have, for the first time, made it possible for "mere mortals" to design their own presence-only models without the distortions described in the previous section.

Models fitted using MaxEnt/Poisson regression can’t be scaled to probability of presence without some additional information - and even then I’m not sure how you’d do it. Equally presence-absence models (binomial likelihood) models fitted to presence-background data will give a different predicted ‘probability’ depending on the number of pseudo-absence points used. This is a point well understood by people who research SDMs, but hardly at all by those who use them – a serious failing on our (SDM researchers) part.

## Incorporating prevalence

The information missing from presence-background models but which is needed to predict probability of presence is the prevalence of the species (proportion of pixels inhabited) in the study area. Gill Ward did some really nice work in this area ([Ward (2007)](http://www.stanford.edu/~hastie/THESES/Gill_Ward.pdf)). She also proposed an expectation-maximisation (EM) algorithm to fit almost any presence-absence model to presence-background data given a prevalence estimate and which will return  valid probability of presence ([Ward *et al.* (2008)](http://www.stanford.edu/~hastie/Papers/Ecology/POBiometrics.pdf)). [Phillips & Elith (2013)](http://www.esajournals.org/doi/abs/10.1890/12-1520.1) suggested similar approach, but used a ‘scaled binomial’ likelihood and [Steinberg & Cardell (1992)](http://www.tandfonline.com/doi/abs/10.1080/03610929208830787#.Ut1RqhBFBaQ) proposed yet another (though in a statistics journal) previously.

A cheap hack for this problem is just to fit a presence-absence model to presence-background data, selecting the number of background points so that the ratio of presence/background records is the ratio of presence/absence records that would be expected under the specified prevalence. This performed surprisingly well when compared to the EM, scaled binomial and Steinberg & Cardell approaches (see figure 4.3.1 in [my thesis](http://figshare.com/articles/PhD_thesis_Mapping_and_understanding_the_distributions_of_potential_vector_mosquitoes_in_the_UK_New_methods_and_applications/767289)) and did better than MaxEnt’s logistic output when the correct prevalence was specified rather than the 0.5 default. In fact in certain circumstances MaxEnt does better when you provide the wrong prevalence value than with the correct one, which is worrying.

In chapter 4 of my thesis I also demonstrated a simple MCMC approach to fit an equivalent of the scaled binomial and EM approaches using an uncertain prevalence estimate. This uses a likelihood proposed by [Lancaster & Imbens (1996)](http://scholar.harvard.edu/files/imbens/files/case-control_studies_with_contaminated_controls.pdf) which also forms the basis for the EM algorithm though in this case I sample a prevalence estimate directly from a prior and don’t do any inference. As far as I’m concerned this is the most ‘correct’ approach to fitting these models and is easy to implement if MCMC is already being used. The non-convex nature of the likelihood makes inference by other methods difficult though and unfortunately MCMC is likely to be a bit beyond most users of SDMs, both in computation time, the required supervision and training required.

I did something similar to this in my thesis (chapter 6) using the ‘cheap hack’ described above and used numerical integration to incorporate uncertainty in the prevalence estimate, using this to map mosquito distributions in the UK.

## Inferring prevalence

This is where it gets a bit weird. If you have a sample of only the presence points, but no prevalence estimate you should be able to get a relative probability of presence, or an intensity surface, fairly easily. Though you might expect not to be able to predict the absolute probability of presence since the intercept term and the sampling rate are unidentifiable ([Phillips & Elith (2013)](http://www.esajournals.org/doi/abs/10.1890/12-1520.1)), i.e. if you have 10 occurrence records, it’s unclear whether the species is very common but poorly sampled or it’s rare and very well sampled.

It turns out that you have a bit of traction on this problem if you make a fairly strong assumption about model structure. This was noted by [Lancaster & Imbens (1996)](http://scholar.harvard.edu/files/imbens/files/case-control_studies_with_contaminated_controls.pdf) and subsequently by ecologists [Lele & Keim (2006)]("http://www.esajournals.org/doi/abs/10.1890/0012-9658(2006)87%5B3021%3AWDAEOR%5D2.0.CO%3B2") who suggested it for SDM. [Royle *et al.* (2013)](http://onlinelibrary.wiley.com/doi/10.1111/j.2041-210X.2011.00182.x/pdf) popularised this, made a direct link to the MaxEnt literature and wrote and promoted an R package ‘maxlike’ to infer absolute probability of presence from presence-background data. [Divino *et al.* (2011a)](https://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CC8QFjAA&url=http%3A%2F%2Fwww.sciencedirect.com%2Fscience%2Farticle%2Fpii%2FS1878029611001356&ei=xFXdUuKxEO7H7Ab6hIHwCw&usg=AFQjCNG6JHr7EIuwL_xrL2YgNKFq2el2Sw&bvm=bv.59568121,d.ZGU) proposed an MCMC algorithm to do the same thing, citing only Ward, though to my knowledge no-one in ecology has spotted this paper yet (note they also suggested a spatially explicit application of this approach: [Divino *et al.* (2011b)](https://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CDoQFjAB&url=http%3A%2F%2Faisberg.unibg.it%2Fbitstream%2F10446%2F25257%2F1%2F23.pdf&ei=C1bdUv2mNaK07QbUzIHoDA&usg=AFQjCNE951ygqBHEGxVzVCYX5C-DzVn-MQ&bvm=bv.59568121,d.ZGU)). [Merow & Silander (2013)](http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12152/abstract) and [Fitzpatrick *et al.* (2013)](https://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CC8QFjAA&url=http%3A%2F%2Fwww.esajournals.org%2Fdoi%2Fabs%2F10.1890%2FES13-00066.1&ei=2lndUqXCB4nF7AaRhIHQAw&usg=AFQjCNGggaoGunYRR3f4H_AnqykOMaDV2A&bvm=bv.59568121,d.ZGU) tested MaxLike on real data and suggested that it gave good predictions. Inexplicably though, both papers evaluated model by AUC and correlation to test data – both methods which are insensitive to calibration accuracy – the whole point of getting absolute probability of presence!

In fact Gill Ward had already looked at this and provided a proof (section 6.7 of [her thesis](http://www.stanford.edu/~hastie/THESES/Gill_Ward.pdf)) that the prevalence is not identifiable if no assumptions are made about model structure (as in the BRT approaches she was interested in). She also suggests that the method is so sensitive to model structure that this approach is to be avoided altogether. [Phillips & Elith (2013)](http://www.esajournals.org/doi/abs/10.1890/12-1520.1) wrote an article responding to the Royle and Lele & Keim papers, reiterating this point and demonstrating it with simulated data.  [Hastie & Fithian (2013)](http://www.stanford.edu/~hastie/Papers/ECOGRAPHY_E0321.pdf) wrote a terser paper in the same vein and give what I think is the best explanation of how the method could work at all and why it should never be used in practice.

 
